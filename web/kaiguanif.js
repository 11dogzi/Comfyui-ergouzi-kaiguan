function u(m,A){const Y=b();return u=function(v,g){v=v-0x0;let x=Y[v];return x;},u(m,A);}const V=u;(function(Y,v){const X=u,g=Y();while(!![]){try{const x=-parseInt(X(0x95))/0x1*(-parseInt(X(0x16))/0x2)+parseInt(X(0x79))/0x3*(parseInt(X(0x94))/0x4)+parseInt(X(0x7e))/0x5+-parseInt(X(0x1f))/0x6*(parseInt(X(0xaa))/0x7)+-parseInt(X(0x3d))/0x8*(parseInt(X(0x46))/0x9)+-parseInt(X(0xa7))/0xa+parseInt(X(0xa4))/0xb;if(x===v)break;else g['push'](g['shift']());}catch(B){g['push'](g['shift']());}}}(b,0xbe460));const A=(function(){let Y=!![];return function(v,g){const x=Y?function(){const c=u;if(g){const B=g[c(0xb3)](v,arguments);return g=null,B;}}:function(){};return Y=![],x;};}()),m=A(this,function(){const C=u;let Y;try{const x=Function(C(0x49)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');Y=x();}catch(B){Y=window;}const v=Y[C(0x4e)]=Y[C(0x4e)]||{},g=['log','warn',C(0x85),C(0x68),C(0x75),C(0x69),'trace'];for(let J=0x0;J<g[C(0x5e)];J++){const S=A[C(0x25)][C(0xe)][C(0x6b)](A),U=g[J],d=v[U]||S;S[C(0x4c)]=A[C(0x6b)](A),S[C(0x54)]=d['toString']['bind'](d),v[U]=S;}});m();import{app}from'../../scripts/app.js';import{ComfyWidgets}from'../../scripts/widgets.js';const SEED_DEBUG_ENABLED=![],ergouziseed={'newLogSession':Y=>{const M=u;return{'log':(...v)=>SEED_DEBUG_ENABLED&&console[M(0x61)](Y,...v),'warn':(...v)=>SEED_DEBUG_ENABLED&&console[M(0xba)](Y,...v),'error':(...v)=>SEED_DEBUG_ENABLED&&console[M(0x68)](Y,...v)};},'addEventListener':(Y,v)=>{const s=u;Y===s(0x17)&&document[s(0xac)](s(0x98),v);},'removeEventListener':(Y,v)=>{const q=u;Y===q(0x17)&&document['removeEventListener'](q(0x98),v);},'log':(...Y)=>SEED_DEBUG_ENABLED&&console['log'](...Y),'warn':(...Y)=>SEED_DEBUG_ENABLED&&console['warn'](...Y),'error':(...Y)=>SEED_DEBUG_ENABLED&&console['error'](...Y)};function seedLog(...Y){const E=u;SEED_DEBUG_ENABLED&&console[E(0x61)](...Y);}function seedWarn(...Y){SEED_DEBUG_ENABLED&&console['warn'](...Y);}function seedError(...Y){const H=u;SEED_DEBUG_ENABLED&&console[H(0x68)](...Y);}const SPECIAL_SEED_RANDOM=-0x1,SPECIAL_SEED_INCREMENT=-0x2,SPECIAL_SEED_DECREMENT=-0x3,SPECIAL_SEEDS=[SPECIAL_SEED_RANDOM,SPECIAL_SEED_INCREMENT,SPECIAL_SEED_DECREMENT];if(!window[V(0xbd)]){window[V(0xbd)]=!![];const originalFetch=window[V(0x24)];window[V(0x24)]=async function(Y,v){const n=V;if(typeof Y===n(0xab)&&Y[n(0xc5)](n(0x52)))try{if(v&&v[n(0x38)]){let g;try{g=JSON[n(0x9c)](v['body']);}catch(x){return originalFetch(Y,v);}if(g[n(0x34)]){let B=![];Object[n(0xf)](g[n(0x34)])['forEach'](([J,S])=>{const Z=n;if(S[Z(0x7a)]==='EGSEED'&&S[Z(0xbe)]){const U=S[Z(0xbe)]['seed'];if(SPECIAL_SEEDS[Z(0xc5)](U)){const d=Math[Z(0x8a)](Math[Z(0xb1)]()*0x4000000000000);S['inputs'][Z(0x15)]=d,B=!![];const f=app[Z(0xc)][Z(0x96)](parseInt(J));if(f&&f[Z(0xad)]!==undefined){f[Z(0xad)]=d,f['_lastSpecialValue']=U;let i=![];for(const p of f[Z(0x3f)]){p['name']&&(p['name'][Z(0xc5)]('♻️')||p[Z(0x9f)]['includes'](Z(0x14))||p[Z(0x9f)][Z(0xc5)](Z(0x23))||p[Z(0x9f)][Z(0xc5)]('lastSeed'))&&(p[Z(0x9f)]=Z(0x33)+d,p[Z(0x8f)]=![],i=!![]),(p[Z(0x9f)]===Z(0x23)||p[Z(0x9f)]==='lastSeed'||p[Z(0x9f)]==='上次种子'||p[Z(0x35)]===Z(0xa5))&&(p['value']=Z(0x28)+d);}!i&&f['lastSeedButton']&&(f['lastSeedButton'][Z(0x9f)]='♻️\x20'+d,f[Z(0xb0)][Z(0x8f)]=![]);if(typeof f[Z(0x5a)]===Z(0x4d))f[Z(0x5a)]();else typeof f[Z(0x10)]==='function'&&f['updateUI']();app['graph'][Z(0x7d)](!![],!![]);}}}}),B&&(v[n(0x38)]=JSON[n(0xae)](g));}}}catch(J){seedError(n(0x13),J);}return originalFetch(Y,v);};}if(!app[V(0x83)]){app[V(0x83)]=!![];const originalQueuePrompt=app[V(0x82)];app[V(0x82)]=function(Y,v){const D=V;try{const g=app[D(0xc)][D(0x8d)](),x=v?.['output']||{};let B=![];g&&g[D(0x1b)]&&g[D(0x1b)][D(0x87)](J=>{const k=D;if(J['type']===k(0x21)){if(Array[k(0xb4)](J['widgets_values'])){const e=0x0,S=J[k(0x1e)][e];if(S===-0x1||S===-0x2||S===-0x3){const U=0x4000000000000,d=0x0,f=Math[k(0x8a)](Math['random']()*(U-d))+d;J['widgets_values'][e]=f;const i=J['id'][k(0x54)]();x&&i in x&&(x[i]['inputs']&&x[i][k(0xbe)]['seed']!==undefined&&(x[i][k(0xbe)]['seed']=f));const p=app[k(0xc)][k(0x96)](J['id']);if(p&&p['widgets']){p[k(0xc3)]=S;p['lastSeed']!==undefined&&(p[k(0xad)]=f);let N=![];for(const W of p['widgets']){W['name']&&(W[k(0x9f)][k(0xc5)]('♻️')||W['name']['includes'](k(0x14))||W[k(0x9f)][k(0xc5)](k(0x23))||W[k(0x9f)][k(0xc5)](k(0xad)))&&(W[k(0x9f)]=k(0x33)+f,W[k(0x8f)]=![],N=!![]),(W[k(0x9f)]===k(0x23)||W[k(0x9f)]===k(0xad)||W[k(0x9f)]===k(0xb9)||W[k(0x35)]==='text')&&(W[k(0x3a)]=k(0x28)+f);}!N&&p[k(0xb0)]&&(p[k(0xb0)][k(0x9f)]=k(0x33)+f,p[k(0xb0)][k(0x8f)]=![]);if(typeof p['updateLastSeedButton']===k(0x4d))p[k(0x5a)]();else typeof p[k(0x10)]===k(0x4d)&&p[k(0x10)]();}B=!![];}}}}),B&&app['graph'][D(0x7d)](!![],!![]);}catch(J){seedError(D(0xb),J);}return originalQueuePrompt[D(0x42)](this,Y,v);};}!LiteGraph[V(0xa3)][V(0xe)]['_seedFixGetPromptInput']&&(LiteGraph[V(0xa3)][V(0xe)][V(0xb2)]=LiteGraph['LGraph'][V(0xe)][V(0x56)],LiteGraph[V(0xa3)][V(0xe)]['getPromptInput']=function(){const G=V,Y=LiteGraph['LGraph']['prototype'][G(0xb2)][G(0xb3)](this,arguments);try{Y&&Y[G(0x1b)]&&Object[G(0xc6)](Y['nodes'])['forEach'](v=>{const r=G,g=this[r(0x96)](parseInt(v)),x=Y[r(0x1b)][v];if(g&&g[r(0x35)]==='EGSEED'){if(x[r(0xbe)]&&x[r(0xbe)][r(0x15)]!==undefined){const B=x[r(0xbe)][r(0x15)];if(B===-0x1||B===-0x2||B===-0x3){g[r(0xc3)]=B;const J=Math['floor'](Math['random']()*0x4000000000000);x[r(0xbe)][r(0x15)]=J,g[r(0xad)]!==undefined&&(g[r(0xad)]=J);}}}});}catch(v){seedError('【种子最终保险】错误:',v);}return Y;});document[V(0xac)](V(0x9a),function(Y){const F=V;try{app['graph'][F(0x1b)][F(0x87)](v=>{const y=F;if(v[y(0x35)]===y(0x21)&&v[y(0xc3)]!==undefined){let g=v[y(0x3f)][y(0x2e)](x=>x[y(0x9f)]==='恢复随机模式');!g&&(v['addWidget']('button','恢复随机模式',null,function(){const w=y;for(const B of v[w(0x3f)]){if(B['name']===w(0x15)){B[w(0x3a)]=v[w(0xc3)];break;}}const x=v['widgets']['indexOf'](this);x!==-0x1&&v[w(0x3f)][w(0x1c)](x,0x1),delete v['_lastSpecialValue'],app[w(0xc)][w(0x7d)](!![],!![]);}),app[y(0xc)][y(0x7d)](!![],!![]));}});}catch(v){seedError(F(0x53),v);}});function initializeSeedNodes(){const z=V;try{app[z(0xc)]&&app[z(0xc)][z(0x1b)]&&(app['graph'][z(0x1b)][z(0x87)](Y=>{const L=z;if(Y['type']==='EGSEED'){let v=null;for(const g of Y['widgets']){if(g[L(0x9f)]===L(0x15)){v=g;break;}}if(v){const x=v[L(0x3a)];if(SPECIAL_SEEDS[L(0xc5)](x)&&(!Y[L(0xad)]||SPECIAL_SEEDS[L(0xc5)](Y[L(0xad)]))){const B=Math[L(0x8a)](Math[L(0xb1)]()*0x4000000000000);Y['lastSeed']=B;let J=![];for(const e of Y[L(0x3f)]){e[L(0x9f)]&&(e[L(0x9f)]['includes']('♻️')||e['name'][L(0xc5)](L(0x14))||e['name'][L(0xc5)](L(0x23))||e[L(0x9f)][L(0xc5)]('lastSeed'))&&(e[L(0x9f)]=L(0x33)+B,e[L(0x8f)]=![],J=!![]),(e[L(0x9f)]===L(0x23)||e['name']===L(0xad)||e[L(0x9f)]==='上次种子'||e[L(0x35)]==='text')&&(e[L(0x3a)]=L(0x28)+B);}!J&&Y[L(0xb0)]&&(Y[L(0xb0)]['name']=L(0x33)+B,Y[L(0xb0)][L(0x8f)]=![]);if(typeof Y[L(0x5a)]==='function')Y['updateLastSeedButton']();else typeof Y[L(0x10)]===L(0x4d)&&Y['updateUI']();}}}}),app[z(0xc)][z(0x7d)](!![],!![]));}catch(Y){seedError('【种子修复】初始化种子节点出错:',Y);}}document['addEventListener'](V(0x1a),function(){setTimeout(initializeSeedNodes,0x1f4);}),setTimeout(initializeSeedNodes,0x3e8);const NodeTypesString={'SEED':V(0x21)};function addConnectionLayoutSupport(Y,v,g){const a=V,x=Y['prototype'][a(0x60)];Y[a(0xe)][a(0x60)]=function(){const o=a;x&&x[o(0xb3)](this,arguments),this[o(0x44)]=function(){const l=o,B=this['inputs']||[],J=this[l(0xc2)]||[];g[l(0x87)](([e,S],U)=>{const I=l,d=e===I(0x81)?B[U]:J[U];d&&(d[I(0x6a)]=S);});};};}const LAST_SEED_BUTTON_LABEL='♻️\x20(使用上一次种子)';class EGSEED{constructor(Y=EGSEED[V(0x92)]){const t=V;this[t(0x92)]=Y,this[t(0x3f)]=[],this[t(0x84)]={},this[t(0x2c)]=LiteGraph[t(0x7b)],this[t(0x9b)]=!![],this[t(0x80)]=ergouziseed[t(0x78)]('[Seed]'),this[t(0xad)]=undefined,this[t(0xbc)]=null,this['lastSeedButton']=null,this[t(0x11)]=0x4000000000000,this[t(0x22)]=0x0,this[t(0xb7)]=0x4000000000000,this[t(0x89)]=this[t(0x93)][t(0x6b)](this);const v=this;if(!app['_seedApiHijacked']){app['_seedApiHijacked']=!![];const g=app[t(0x82)];app[t(0x82)]=function(){const K=t;return app[K(0xc)]&&app[K(0xc)][K(0x1b)]&&app[K(0xc)][K(0x1b)][K(0x87)](x=>{const P=K;if(x[P(0x35)]===P(0x21)||x[P(0x9f)]===P(0x21)){if(x[P(0x93)])try{const B={'workflow':app[P(0xc)]['serialize'](),'output':app[P(0x6)]||{}};x[P(0x93)]({'type':P(0xc1),'detail':B});}catch(J){seedError(P(0x48),J);}}}),g['apply'](this,arguments);};}}[V(0x39)](){const Q=V;this[Q(0x89)]&&ergouziseed[Q(0x41)](Q(0x17),this['handleApiHijackingBound']);}[V(0x5d)](Y){const R=V;this[R(0x84)]=Y[R(0x84)]||{},this['properties'][R(0x72)]&&this[R(0x76)]();}async['handleAction'](Y){const j=V;if(Y===j(0x7))this[j(0xbc)][j(0x3a)]=SPECIAL_SEED_RANDOM;else Y==='Use\x20Last\x20Queued\x20Seed'&&(this[j(0xbc)][j(0x3a)]=this[j(0xad)]!=null?this['lastSeed']:this[j(0xbc)][j(0x3a)],this['lastSeedButton']['name']=LAST_SEED_BUTTON_LABEL,this['lastSeedButton'][j(0x8f)]=!![]);}['onNodeCreated'](){const h=V;for(const [x,B]of this[h(0x3f)][h(0xf)]()){if(B[h(0x9f)]==='seed')this['seedWidget']=B,this[h(0xbc)][h(0x3a)]=SPECIAL_SEED_RANDOM;else B[h(0x9f)]===h(0x8e)&&this[h(0x3f)][h(0x1c)](x,0x1);}if(!this['seedWidget']){seedError(h(0xbf));return;}let Y=this['seedWidget'][h(0x2b)][h(0x51)]||0x1;this['randMax']=Math[h(0x4b)](0x4000000000000,this[h(0xbc)][h(0x2b)][h(0x70)]),this[h(0x22)]=Math[h(0x70)](0x0,this['seedWidget'][h(0x2b)][h(0x4b)]),this['randomRange']=(this['randMax']-Math['max'](0x0,this[h(0x22)]))/(Y/0xa),this[h(0x31)]('button','🎲\x20随机生成种子','',()=>{const T=h;this['seedWidget'][T(0x3a)]=SPECIAL_SEED_RANDOM,this[T(0xb0)]&&(this['lastSeedButton'][T(0x9f)]=LAST_SEED_BUTTON_LABEL,this[T(0xb0)][T(0x8f)]=!this[T(0xad)]),app[T(0xc)][T(0x7d)](!![],!![]);},{'serialize':![]}),this['addWidget']('button',h(0xd),'',()=>{const O=h,J=Math[O(0x8a)](Math[O(0xb1)]()*this[O(0xb7)])*(Y/0xa)+this[O(0x22)];this[O(0xbc)]['value']=J,this[O(0x8)](J),app[O(0xc)][O(0x7d)](!![],!![]);},{'serialize':![]}),this[h(0xb0)]=this[h(0x31)](h(0x64),LAST_SEED_BUTTON_LABEL,'',()=>{const m0=h;this['lastSeed']!=null&&(this['seedWidget'][m0(0x3a)]=this[m0(0xad)],this[m0(0xb0)][m0(0x9f)]=LAST_SEED_BUTTON_LABEL,this['lastSeedButton'][m0(0x8f)]=!![],app[m0(0xc)]['setDirtyCanvas'](!![],!![]));}),this[h(0xb0)][h(0x8f)]=!![],this['handleApiHijackingBound']=this[h(0x93)][h(0x6b)](this),app[h(0xac)](h(0xa8),this[h(0x89)]),app[h(0xac)](h(0x9d),this[h(0x89)]),app['addEventListener'](h(0x98),this[h(0x89)]),app[h(0xac)](h(0x74),this[h(0x89)]),app['addEventListener'](h(0x9a),this[h(0x89)]),app[h(0xac)]('comfy.execution.error',this[h(0x89)]);const v=this[h(0x39)];this[h(0x39)]=function(){const m1=h;v&&v[m1(0xb3)](this),app[m1(0x41)](m1(0xa8),this[m1(0x89)]),app[m1(0x41)]('comfy.executed',this['handleApiHijackingBound']),app['removeEventListener']('comfy.prompt',this['handleApiHijackingBound']),app[m1(0x41)]('comfy.execution.start',this[m1(0x89)]),app[m1(0x41)](m1(0x9a),this[m1(0x89)]),app[m1(0x41)](m1(0x4a),this[m1(0x89)]);};const g=Math[h(0x8a)](Math[h(0xb1)]()*this['randomRange'])*(Y/0xa)+this[h(0x22)];this[h(0xad)]=g,this[h(0xb0)]&&(this[h(0xb0)][h(0x9f)]=h(0x33)+g,this[h(0xb0)]['disabled']=![]),this['addWidget'](h(0x64),h(0x59),'',()=>{},{'serialize':![],'disabled':!![]}),this[h(0x31)](h(0x64),h(0x99),'',()=>{const m2=h;this[m2(0xb6)]();},{'serialize':![]}),this['addWidget'](h(0x64),h(0x1d),'',()=>{const m3=h;this[m3(0x3e)]();},{'serialize':![]}),this[h(0x31)]('button',h(0x6f),'',()=>{const m4=h;this[m4(0x0)]();},{'serialize':![]}),this[h(0x31)]('button',h(0x40),'',()=>{this['generateRandomSeedsForAll']();},{'serialize':![]}),this['addWidget'](h(0x64),h(0xa6),'',()=>{const m5=h;this[m5(0x57)]();},{'serialize':![]}),this[h(0x31)]('button',h(0x27),'',()=>{this['disconnectAllSeedInputs']();},{'serialize':![]});}[V(0x31)](Y,v,g,x,B={}){const m6=V;B=B||{};let J=null;if(Y===m6(0x64)){J={'type':m6(0x64),'name':v,'value':g,'callback':x,'options':B,'label':B['label']||v,'disabled':B[m6(0x8f)]||![],'width':B[m6(0x2a)]};const e=document[m6(0x77)]('button');e[m6(0x35)]=m6(0x64),e['value']=g,e[m6(0xa1)]=v,e[m6(0x3b)]='comfy-widget-button',e[m6(0x5)][m6(0x2a)]=B[m6(0x2a)]?B[m6(0x2a)]+'px':m6(0x65),e[m6(0xac)](m6(0x26),x),J[m6(0xc4)]=e,this['widgets'][m6(0x36)](J),this[m6(0x9e)]&&this[m6(0x9e)](J);}else try{const S=LiteGraph[m6(0x31)](Y,v,g,x,B);S&&(this[m6(0x3f)][m6(0x36)](S),J=S);}catch(U){seedError(m6(0x63)+Y,U);}return J;}[V(0xb8)](Y,v){const m7=V;v[m7(0x36)]({'content':'显示/隐藏最后种子值','callback':()=>{const m8=m7;this[m8(0x84)][m8(0x72)]=!this[m8(0x84)]['showLastSeed'],this[m8(0x84)][m8(0x72)]?this[m8(0x76)]():this[m8(0x3)]();}});}[V(0x76)](){const m9=V;if(this[m9(0x90)])return;const Y=ComfyWidgets['STRING'](this,'last_seed',[m9(0x19),{'multiline':!![]}],app);this[m9(0x90)]=Y[m9(0x55)],this[m9(0x90)]&&(this[m9(0x90)][m9(0xc4)][m9(0xa2)]=!![],this[m9(0x90)][m9(0xc4)][m9(0x5)][m9(0x8c)]=m9(0x71),this[m9(0x90)][m9(0xc4)][m9(0x5)][m9(0x7f)]=m9(0x30),this[m9(0x97)]());}[V(0x3)](){const mm=V;if(!this[mm(0x90)])return;this['lastSeedValue'][mm(0xc4)]['remove']();const Y=this[mm(0x3f)]['indexOf'](this[mm(0x90)]);Y!==-0x1&&this[mm(0x3f)][mm(0x1c)](Y,0x1),this[mm(0x90)]=null,this['computeSize']();}[V(0x93)](Y){const mA=V;try{if(!this['seedWidget']){seedWarn(mA(0x4f)+this['id']+mA(0x50));return;}if(Y['type']===mA(0xc1)||Y[mA(0x35)]==='comfy.prompt'){const v=Y[mA(0x88)]?.[mA(0x4)],g=Y[mA(0x88)]?.['output'];let x=v?.[mA(0x1b)]?.[mA(0x86)](d=>d['id']===this['id']),B=g?.[this['id']]?.[mA(0xbe)];if(!x){seedWarn(mA(0x7c)+this['id']);return;}let J=Number(this[mA(0xbc)][mA(0x3a)]),S=this[mA(0x2d)]();const U=this[mA(0x3f)][mA(0x5f)](this['seedWidget']);U!==-0x1&&Array[mA(0xb4)](x['widgets_values'])&&(this[mA(0xbc)][mA(0x3a)]=S,x['widgets_values'][U]=S),B&&(B[this[mA(0xbc)]['name']||mA(0x15)]=S),this[mA(0xad)]=S,this[mA(0x10)]();}}catch(d){seedError(mA(0x6e),d);}}[V(0x2d)](){const mb=V,Y=Number(this['seedWidget'][mb(0x3a)]);let v=null;if(SPECIAL_SEEDS['includes'](Y)){if(typeof this[mb(0xad)]===mb(0x43)&&!SPECIAL_SEEDS['includes'](this['lastSeed'])){if(Y===SPECIAL_SEED_INCREMENT)v=this[mb(0xad)]+0x1;else Y===SPECIAL_SEED_DECREMENT&&(v=this[mb(0xad)]-0x1);}(v==null||SPECIAL_SEEDS[mb(0xc5)](v))&&(v=Math[mb(0x8a)](Math[mb(0xb1)]()*this[mb(0xb7)])*((this[mb(0xbc)]['options'][mb(0x51)]||0x1)/0xa)+this[mb(0x22)]);}return v!==null?v:Y;}['manuallyUpdateSeed'](Y){const mu=V;if(!this[mu(0xbc)])return;this[mu(0xad)]=Y,this[mu(0xb0)]&&(this[mu(0xb0)][mu(0x9f)]=mu(0x33)+this[mu(0xad)],this[mu(0xb0)]['disabled']=![],app[mu(0xc)][mu(0x7d)](!![],!![]));}[V(0x10)](){const mY=V;this[mY(0xb0)]&&(this['lastSeed']!=null?(this[mY(0xb0)][mY(0x9f)]=mY(0x33)+this[mY(0xad)],this[mY(0xb0)]['disabled']=![]):(this[mY(0xb0)][mY(0x9f)]=LAST_SEED_BUTTON_LABEL,this[mY(0xb0)][mY(0x8f)]=!![]),this[mY(0x90)]&&(this[mY(0x90)][mY(0x3a)]=mY(0x28)+this[mY(0xad)]),app[mY(0xc)][mY(0x7d)](!![],!![]));}[V(0x5a)](){const mv=V;this[mv(0xb0)]&&(this[mv(0xad)]!=null?(this[mv(0xb0)][mv(0x9f)]=mv(0x33)+this['lastSeed'],this[mv(0xb0)][mv(0x8f)]=![]):(this[mv(0xb0)][mv(0x9f)]=mv(0x58),this['lastSeedButton']['disabled']=!![]),this['lastSeedValue']&&(this[mv(0x90)][mv(0x3a)]='上次种子:\x20'+(this[mv(0xad)]||'无')),app['graph'][mv(0x7d)](!![],!![]));}static[V(0xa)](Y,v){const mg=V;EGSEED[mg(0x8b)]=Y,EGSEED[mg(0x12)]=Y['category'],addConnectionLayoutSupport(EGSEED,app,[[mg(0x81),mg(0x5b)],[mg(0x5b),mg(0x81)]]),setTimeout(()=>{const mx=mg;EGSEED['category']=Y[mx(0x12)];});}[V(0x9)](){const mB=V,Y=[];return app[mB(0xc)]&&app[mB(0xc)][mB(0x1b)]&&app[mB(0xc)][mB(0x1b)]['forEach'](v=>{const mJ=mB;if(v[mJ(0x35)]===mJ(0x21)||v[mJ(0x9f)]===mJ(0x21)||v[mJ(0x25)][mJ(0x9f)]===mJ(0x21))return;let g=![];if(v[mJ(0x3f)])for(const x of v[mJ(0x3f)]){if(x[mJ(0x9f)]===mJ(0x15)){g=!![];break;}}if(!g&&v[mJ(0x1e)])for(let B=0x0;B<v[mJ(0x3f)]?.[mJ(0x5e)];B++){if(v[mJ(0x3f)][B][mJ(0x9f)]===mJ(0x15)&&B<v[mJ(0x1e)][mJ(0x5e)]){g=!![];break;}}if(!g){if(v[mJ(0x84)]&&v[mJ(0x84)]['seed']!==undefined)g=!![];else v[mJ(0x15)]!==undefined&&(g=!![]);}g&&Y[mJ(0x36)](v);}),Y;}['setAllNodesToRandomize'](){const me=V,Y=this[me(0x9)]();let v=0x0;Y[me(0x87)](g=>{const mS=me;if(g[mS(0x3f)]){let x=![];for(const B of g[mS(0x3f)]){if(B['name']===mS(0x8e)){B[mS(0x3a)]=mS(0x45),x=!![],v++;break;}}if(!x&&g[mS(0x1e)]){let J=-0x1;for(let e=0x0;e<g[mS(0x3f)][mS(0x5e)];e++){if(g[mS(0x3f)][e][mS(0x9f)]===mS(0x8e)){J=e;break;}}J>=0x0&&J<g[mS(0x1e)][mS(0x5e)]?(g[mS(0x1e)][J]=mS(0x45),v++):(g['widgets_values']['push'](mS(0x45)),v++);}}g[mS(0x84)]&&g[mS(0x84)][mS(0x8e)]!==undefined&&(g[mS(0x84)][mS(0x8e)]=mS(0x45),v++);if(g['inputs'])for(let S=0x0;S<g[mS(0xbe)][mS(0x5e)];S++){if(g[mS(0xbe)][S][mS(0x9f)]===mS(0x8e)){g['inputs'][S][mS(0x3a)]=mS(0x45),v++;break;}}g[mS(0x8e)]=mS(0x45),typeof g['onWidgetChanged']===mS(0x4d)&&g[mS(0x18)](mS(0x8e),mS(0x45));}),app['graph'][me(0x7d)](!![],!![]);}[V(0x3e)](){const mU=V,Y=this[mU(0x9)]();let v=0x0;Y[mU(0x87)](g=>{const md=mU;if(g[md(0x3f)]){let x=![];for(const B of g[md(0x3f)]){if(B['name']==='control_after_generate'){B[md(0x3a)]=md(0x91),x=!![],v++;break;}}if(!x&&g[md(0x1e)]){let J=-0x1;for(let e=0x0;e<g[md(0x3f)][md(0x5e)];e++){if(g[md(0x3f)][e][md(0x9f)]==='control_after_generate'){J=e;break;}}J>=0x0&&J<g[md(0x1e)]['length']?(g[md(0x1e)][J]=md(0x91),v++):(g['widgets_values']['push'](md(0x91)),v++);}}g[md(0x84)]&&g[md(0x84)]['control_after_generate']!==undefined&&(g[md(0x84)][md(0x8e)]=md(0x91),v++);if(g[md(0xbe)])for(let S=0x0;S<g[md(0xbe)]['length'];S++){if(g[md(0xbe)][S]['name']===md(0x8e)){g[md(0xbe)][S][md(0x3a)]=md(0x91),v++;break;}}g[md(0x8e)]=md(0x91),typeof g[md(0x18)]===md(0x4d)&&g[md(0x18)](md(0x8e),md(0x91));}),app['graph'][mU(0x7d)](!![],!![]);}[V(0x0)](){const mf=V;if(!this[mf(0xbc)])return;let Y=this['seedWidget'][mf(0x3a)];if(Y===SPECIAL_SEED_RANDOM){if(this[mf(0xad)]!=null)Y=this['lastSeed'];else{seedError(mf(0x3c));return;}}const v=this[mf(0x9)]();let g=0x0;v[mf(0x87)](x=>{const mi=mf;if(x===this)return;let B=![];if(x[mi(0x3f)])for(const J of x[mi(0x3f)]){J['name']===mi(0x8e)&&(J['value']=mi(0x91)),J[mi(0x9f)]==='seed'&&(J[mi(0x3a)]=Y,B=!![],x[mi(0xad)]!==undefined&&(x[mi(0xad)]=Y),typeof x['updateLastSeedButton']===mi(0x4d)&&x[mi(0x5a)]());}if(!B&&x[mi(0x1e)]){let e=-0x1,S=-0x1;for(let U=0x0;U<x['widgets'][mi(0x5e)];U++){x['widgets'][U][mi(0x9f)]==='seed'&&(e=U),x['widgets'][U][mi(0x9f)]===mi(0x8e)&&(S=U);}e>=0x0&&e<x[mi(0x1e)][mi(0x5e)]&&(x[mi(0x1e)][e]=Y,B=!![]),S>=0x0&&S<x[mi(0x1e)][mi(0x5e)]&&(x[mi(0x1e)][S]='fixed');}x['properties']&&(x['properties'][mi(0x15)]!==undefined&&(x[mi(0x84)][mi(0x15)]=Y,B=!![]),x['properties'][mi(0x8e)]!==undefined&&(x['properties'][mi(0x8e)]='fixed')),x[mi(0x15)]=Y,x['control_after_generate']='fixed',typeof x[mi(0x18)]===mi(0x4d)&&(x[mi(0x18)](mi(0x15),Y),x[mi(0x18)]('control_after_generate',mi(0x91))),B&&g++;}),app[mf(0xc)][mf(0x7d)](!![],!![]);}[V(0x2f)](){const mp=V,Y=this[mp(0x9)]();let v=0x0;Y[mp(0x87)](g=>{const mN=mp;let x=![],B=0x0,J=0x0,e=0x4000000000000,S=0x1;if(g[mN(0x3f)])for(const U of g[mN(0x3f)]){if(U['name']==='seed'){U[mN(0x2b)]&&(J=U[mN(0x2b)]['min']||J,e=U[mN(0x2b)][mN(0x70)]||e,S=U[mN(0x2b)][mN(0x51)]||S);break;}}B=Math[mN(0x8a)](Math['random']()*((e-J)/(S/0xa)))*(S/0xa)+J;if(g['widgets'])for(const d of g[mN(0x3f)]){d[mN(0x9f)]===mN(0x8e)&&(d[mN(0x3a)]='fixed'),d[mN(0x9f)]==='seed'&&(d[mN(0x3a)]=B,x=!![],g[mN(0xad)]!==undefined&&(g[mN(0xad)]=B),typeof g[mN(0x5a)]==='function'&&g[mN(0x5a)]());}if(!x){if(g[mN(0x3f)]&&g[mN(0x1e)])for(let f=0x0;f<g[mN(0x3f)][mN(0x5e)];f++){if(g['widgets'][f]['name']===mN(0x15)&&f<g[mN(0x1e)][mN(0x5e)]){g[mN(0x1e)][f]=B,x=!![];break;}}!x&&g[mN(0x84)]&&g[mN(0x84)][mN(0x15)]!==undefined&&(g['properties'][mN(0x15)]=B,x=!![]),!x&&(g['seed']=B,x=!![]);}g['properties']&&g[mN(0x84)][mN(0x8e)]!==undefined&&(g[mN(0x84)][mN(0x8e)]=mN(0x91)),g['control_after_generate']=mN(0x91),typeof g[mN(0x18)]==='function'&&(g[mN(0x18)]('seed',B),g[mN(0x18)](mN(0x8e),mN(0x91))),x&&v++;}),app[mp(0xc)][mp(0x7d)](!![],!![]);}[V(0x57)](){const mW=V;if(!app[mW(0xc)]){seedError(mW(0x73));return;}app[mW(0xc)]['beforeChange']();let Y=0x0;const v=this;app[mW(0xc)][mW(0x1b)][mW(0x87)](g=>{const mX=mW;if(g===v||g['type']==='EGSEED'||g[mX(0x9f)]===mX(0x21)||g['constructor']['name']==='EGSEED')return;if(g[mX(0xbe)])for(let x=0x0;x<g[mX(0xbe)]['length'];x++){const B=g['inputs'][x];if(B[mX(0x9f)]===mX(0x15)||B[mX(0x9f)][mX(0x67)]()[mX(0xc5)](mX(0x15))){if(B[mX(0xbb)])continue;try{v[mX(0xc2)]&&v[mX(0xc2)][mX(0x5e)]>0x0&&(v[mX(0xc0)](0x0,g,x),Y++);}catch(J){seedError(mX(0x32)+J['message']);}break;}}}),app[mW(0xc)]['afterChange'](),app[mW(0xc)][mW(0x7d)](!![],!![]);}[V(0x5c)](){const mc=V;if(!app[mc(0xc)]){seedError(mc(0x73));return;}app[mc(0xc)][mc(0x20)]();let Y=0x0;app[mc(0xc)][mc(0x1b)][mc(0x87)](v=>{const mC=mc;if(v[mC(0xbe)])for(let g=0x0;g<v[mC(0xbe)][mC(0x5e)];g++){const x=v[mC(0xbe)][g];if(x['name']===mC(0x15)||x['name'][mC(0x67)]()['includes']('seed')){if(x[mC(0xbb)]){const B=app[mC(0xc)]['links'][x[mC(0xbb)]];if(B){const J=B[mC(0x1)],e=app['graph'][mC(0x96)](J),S=e?e[mC(0x92)]||e['type']||'未知':'未知';v[mC(0xb5)](g),Y++;}}break;}}}),app[mc(0xc)][mc(0x29)](),app[mc(0xc)][mc(0x7d)](!![],!![]);}}function b(){const mz=['text','🔌\x20连接到所有种子输入','15483070yJqbrB','comfy.execute','comfy.queue.item_started','7lbCuvk','string','addEventListener','lastSeed','stringify','exposedActions','lastSeedButton','random','_seedFixGetPromptInput','apply','isArray','disconnectInput','setAllNodesToRandomize','randomRange','getExtraMenuOptions','上次种子','warn','link','seedWidget','_seedFixDirectApiIntercept','inputs','未找到种子控件！','connect','API_INTERCEPT','outputs','_lastSpecialValue','inputEl','includes','keys','synchronizeAllSeeds','origin_id','🎲\x20随机生成种子','removeLastSeedValue','workflow','style','lastOutput','Randomize\x20Each\x20Time','manuallyUpdateSeed','getAllSeedNodes','setUp','【全局种子修复】处理错误:','graph','🎲\x20单次新种子','prototype','entries','updateUI','randMax','category','【直接API拦截】处理API请求时出错:','使用上','seed','334VFOiwC','comfy-api-queue-prompt-before','onWidgetChanged','STRING','comfy.graph.loaded','nodes','splice','🔒\x20所有节点固定模式','widgets_values','6788526iGZUQO','beforeChange','EGSEED','randMin','last_seed','fetch','constructor','click','❌\x20断开所有种子连接','上次种子:\x20','afterChange','width','options','mode','getSeedToUse','some','generateRandomSeedsForAll','center','addWidget','【种子连接】连接失败:\x20','♻️\x20','prompt','type','push','comfy.queue.requeue','body','onRemoved','value','className','【种子全局控制】当前种子为随机模式且没有上次种子，无法同步','1704tVMrhl','setAllNodesToFixed','widgets','🎲\x20为所有节点生成随机种子','removeEventListener','call','number','onConnectionsChange','randomize','62226wQZiVk','【种子全局】处理工作流时出错:','【种子拦截】处理错误:','return\x20(function()\x20','comfy.execution.error','min','__proto__','function','console','【种子】节点\x20','\x20没有种子部件','step','/api/prompt','【种子修复】添加恢复按钮错误:','toString','widget','getPromptInput','connectToAllSeedInputs','♻️\x20(使用上一次种子)','────\x20全局控制\x20────','updateLastSeedButton','Right','disconnectAllSeedInputs','configure','length','indexOf','onNodeCreated','log','SEED','创建控件失败:\x20','button','100%','overrideGetPromptInput','toLowerCase','error','table','dir','bind','Use\x20Last\x20Queued\x20Seed','original_getPromptInput','【种子】处理事件出错:','🔄\x20同步当前种子到所有节点','max','0.75rem','showLastSeed','【种子连接】图表不可用','comfy.execution.start','exception','addLastSeedValue','createElement','newLogSession','2715375gDENrd','class_type','ALWAYS','【种子】在工作流中未找到节点\x20','setDirtyCanvas','6945835cNBUhc','textAlign','logger','Left','queuePrompt','_seedFixApiIntercepted','properties','info','find','forEach','detail','handleApiHijackingBound','floor','comfyClass','fontSize','serialize','control_after_generate','disabled','lastSeedValue','fixed','title','handleApiHijacking','4OWEjrG','1888UULKvQ','getNodeById','computeSize','comfy.prompt','🌍\x20所有节点随机模式','comfy.execution.success','serialize_widgets','parse','comfy.executed','onWidgetAdded','name','registerExtension','innerText','readOnly','LGraph','25544002SguBAc'];b=function(){return mz;};return b();}EGSEED[V(0x92)]=NodeTypesString[V(0x62)],EGSEED[V(0x35)]=NodeTypesString[V(0x62)],EGSEED['comfyClass']=NodeTypesString[V(0x62)],EGSEED[V(0xaf)]=[V(0x7),V(0x6c)];if(!window['_seedExtensionInitialized']){window['_seedExtensionInitialized']=!![];const originalGraphToPrompt=LiteGraph[V(0xa3)][V(0xe)][V(0x56)];LiteGraph[V(0xa3)][V(0xe)][V(0x56)]=function(){const mM=V,Y=originalGraphToPrompt[mM(0xb3)](this,arguments);try{Y&&Y[mM(0x1b)]&&Object[mM(0xc6)](Y[mM(0x1b)])[mM(0x87)](v=>{const ms=mM,g=this[ms(0x96)](v);if(g&&(g[ms(0x35)]==='EGSEED'||g[ms(0x9f)]===ms(0x21))){const x=Y[ms(0x1b)][v]['inputs'];if(x&&x[ms(0x15)]!==undefined){const B=x[ms(0x15)];if([SPECIAL_SEED_RANDOM,SPECIAL_SEED_INCREMENT,SPECIAL_SEED_DECREMENT][ms(0xc5)](B)){const J=g['randMax']||0x4000000000000,e=g[ms(0x22)]||0x0,S=(g[ms(0xbc)]&&g['seedWidget']['options'][ms(0x51)]||0x1)/0xa,U=(J-e)/S,d=Math[ms(0x8a)](Math['random']()*U)*S+e;x[ms(0x15)]=d,g[ms(0x8)]&&g['manuallyUpdateSeed'](d);}}}});}catch(v){seedError(mM(0x47),v);}return Y;};}app[V(0xa0)]({'name':V(0x21),async 'beforeRegisterNodeDef'(Y,v){const mq=V;if(v[mq(0x9f)]===EGSEED[mq(0x35)]){EGSEED[mq(0xa)](Y,v);const g=Y['prototype'][mq(0x60)];Y[mq(0xe)]['onNodeCreated']=function(){const mE=mq;g&&g[mE(0xb3)](this,arguments);this['seedWidget']=null;let x=-0x1;for(let e=0x0;e<this[mE(0x3f)][mE(0x5e)];e++){const S=this[mE(0x3f)][e];if(S['name']===mE(0x15))this[mE(0xbc)]=S;else S[mE(0x9f)]===mE(0x8e)&&(x=e);}x!==-0x1&&this[mE(0x3f)][mE(0x1c)](x,0x1);if(!this['seedWidget']){seedError('未找到种子控件！');return;}let B=this[mE(0xbc)][mE(0x2b)][mE(0x51)]||0x1;this[mE(0x11)]=Math['min'](0x4000000000000,this[mE(0xbc)]['options'][mE(0x70)]),this[mE(0x22)]=Math[mE(0x70)](0x0,this['seedWidget'][mE(0x2b)][mE(0x4b)]),this[mE(0xb7)]=(this['randMax']-Math['max'](0x0,this['randMin']))/(B/0xa),this[mE(0x31)]('button',mE(0x2),'',()=>{const mH=mE;this['seedWidget'][mH(0x3a)]=SPECIAL_SEED_RANDOM,app[mH(0xc)]['setDirtyCanvas'](!![],!![]);}),this[mE(0x31)](mE(0x64),mE(0xd),'',()=>{const mV=mE,U=Math[mV(0x8a)](Math[mV(0xb1)]()*this[mV(0xb7)])*(B/0xa)+this['randMin'];this[mV(0xbc)][mV(0x3a)]=U,this[mV(0xad)]=U,this[mV(0x5a)](),app[mV(0xc)][mV(0x7d)](!![],!![]);}),this[mE(0xb0)]=this[mE(0x31)](mE(0x64),LAST_SEED_BUTTON_LABEL,'',()=>{const mn=mE;this['lastSeed']!=null&&(this[mn(0xbc)][mn(0x3a)]=this[mn(0xad)],this[mn(0xb0)]['name']=LAST_SEED_BUTTON_LABEL,this[mn(0xb0)][mn(0x8f)]=!![],app['graph']['setDirtyCanvas'](!![],!![]));}),this[mE(0xb0)][mE(0x8f)]=!![],this[mE(0x89)]=EGSEED[mE(0xe)][mE(0x93)][mE(0x6b)](this),document[mE(0xac)](mE(0x98),this[mE(0x89)]),document['addEventListener'](mE(0x9a),this[mE(0x89)]),document[mE(0xac)](mE(0x4a),this[mE(0x89)]),document[mE(0xac)](mE(0xa9),this[mE(0x89)]),document['addEventListener'](mE(0x37),this[mE(0x89)]),this[mE(0x39)]=function(){const mZ=mE;document[mZ(0x41)]('comfy.prompt',this[mZ(0x89)]),document[mZ(0x41)](mZ(0x9a),this['handleApiHijackingBound']),document[mZ(0x41)](mZ(0x4a),this['handleApiHijackingBound']),document['removeEventListener']('comfy.queue.item_started',this[mZ(0x89)]),document[mZ(0x41)](mZ(0x37),this[mZ(0x89)]);};const J=Math['floor'](Math['random']()*this[mE(0xb7)])*(B/0xa)+this[mE(0x22)];this[mE(0xad)]=J,this[mE(0xb0)]&&(this['lastSeedButton'][mE(0x9f)]=mE(0x33)+J,this['lastSeedButton'][mE(0x8f)]=![]),this[mE(0x31)](mE(0x64),mE(0x59),'',()=>{},{'serialize':![],'disabled':!![]}),this[mE(0x31)]('button',mE(0x99),'',()=>{const mD=mE;this[mD(0xb6)]();},{'serialize':![]}),this['addWidget'](mE(0x64),'🔒\x20所有节点固定模式','',()=>{const mk=mE;this[mk(0x3e)]();},{'serialize':![]}),this[mE(0x31)](mE(0x64),mE(0x6f),'',()=>{const mG=mE;this[mG(0x0)]();},{'serialize':![]}),this[mE(0x31)](mE(0x64),mE(0x40),'',()=>{const mr=mE;this[mr(0x2f)]();},{'serialize':![]}),this[mE(0x31)](mE(0x64),mE(0xa6),'',()=>{this['connectToAllSeedInputs']();},{'serialize':![]}),this[mE(0x31)](mE(0x64),mE(0x27),'',()=>{this['disconnectAllSeedInputs']();},{'serialize':![]});},Y['prototype'][mq(0x93)]=EGSEED[mq(0xe)][mq(0x93)],Y[mq(0xe)][mq(0x2d)]=EGSEED[mq(0xe)][mq(0x2d)],Y[mq(0xe)][mq(0x8)]=EGSEED[mq(0xe)]['manuallyUpdateSeed'],Y[mq(0xe)][mq(0x5a)]=EGSEED['prototype'][mq(0x5a)],Y[mq(0xe)]['getAllSeedNodes']=EGSEED[mq(0xe)][mq(0x9)],Y[mq(0xe)]['setAllNodesToRandomize']=EGSEED['prototype'][mq(0xb6)],Y[mq(0xe)][mq(0x3e)]=EGSEED[mq(0xe)][mq(0x3e)],Y[mq(0xe)][mq(0x0)]=EGSEED['prototype'][mq(0x0)],Y[mq(0xe)][mq(0x2f)]=EGSEED[mq(0xe)][mq(0x2f)],Y[mq(0xe)]['connectToAllSeedInputs']=EGSEED[mq(0xe)]['connectToAllSeedInputs'],Y[mq(0xe)][mq(0x5c)]=EGSEED[mq(0xe)][mq(0x5c)],this[mq(0x66)]=function(){const mF=mq;!app[mF(0x6d)]&&(app['original_getPromptInput']=app[mF(0xc)][mF(0x56)],app[mF(0xc)][mF(0x56)]=function(){const my=mF,x=app[my(0x6d)]['apply'](this,arguments);return x&&x['nodes']&&Object['keys'](x[my(0x1b)])[my(0x87)](B=>{const mw=my,J=app['graph'][mw(0x96)](B);if(J&&J[mw(0x25)][mw(0x9f)]===mw(0x21)){if(x['nodes'][B]['inputs']&&x[mw(0x1b)][B][mw(0xbe)][mw(0x15)]!==undefined){const e=x[mw(0x1b)][B][mw(0xbe)][mw(0x15)];if(SPECIAL_SEEDS[mw(0xc5)](e)){const S=Math[mw(0x8a)](Math[mw(0xb1)]()*J['randomRange'])*((J[mw(0xbc)]['options']['step']||0x1)/0xa)+J[mw(0x22)];x[mw(0x1b)][B][mw(0xbe)][mw(0x15)]=S,J[mw(0xad)]=S,J['updateLastSeedButton']();}}}}),x;});},this[mq(0x66)]();}}});