const TG=b;(function(R,K){const M=b,p=R();while(!![]){try{const k=parseInt(M(0x47))/0x1*(parseInt(M(0x24))/0x2)+-parseInt(M(0xa8))/0x3*(parseInt(M(0xac))/0x4)+-parseInt(M(0x52))/0x5*(parseInt(M(0xa4))/0x6)+parseInt(M(0x18))/0x7*(parseInt(M(0x4a))/0x8)+parseInt(M(0x89))/0x9*(-parseInt(M(0x96))/0xa)+parseInt(M(0xba))/0xb+parseInt(M(0x87))/0xc*(parseInt(M(0xc2))/0xd);if(k===K)break;else p['push'](p['shift']());}catch(s){p['push'](p['shift']());}}}(g,0x53bee));const I=(function(){let R=!![];return function(K,p){const k=R?function(){const U=b;if(p){const s=p[U(0x6b)](K,arguments);return p=null,s;}}:function(){};return R=![],k;};}()),T=I(this,function(){const S=b,R=function(){const Y=b;let s;try{s=Function(Y(0x66)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(A){s=window;}return s;},K=R(),p=K[S(0x8d)]=K['console']||{},k=[S(0xdf),S(0xd),'info',S(0x36),'exception',S(0xa9),S(0x7)];for(let s=0x0;s<k[S(0xe)];s++){const A=I[S(0xd8)]['prototype']['bind'](I),X=k[s],W=p[X]||A;A['__proto__']=I[S(0x44)](I),A[S(0x76)]=W[S(0x76)][S(0x44)](W),p[X]=A;}});T();import{app}from'/scripts/app.js';import{ComfyWidgets}from'/scripts/widgets.js';function getSafeWidgetName(R){const i=b;if(!R)return null;return R[i(0x60)](/[^\w\u4e00-\u9fa5]/g,'_')[i(0x1e)]();}function serializeGroupSwitchWidget(R){const V=b;return{'name':R[V(0x2)],'type':R[V(0x4)],'value':R[V(0x5c)],'api_name':R[V(0x8f)],'api_id':R[V(0x75)],'exposed':R[V(0x23)],'groupName':R['groupName'],'options':R[V(0x69)]?{'values':R['options'][V(0x8)],'min':R[V(0x69)][V(0x81)],'max':R['options'][V(0xe6)],'step':R[V(0x69)][V(0x9d)],'step2':R['options'][V(0xa2)],'precision':R[V(0x69)][V(0xe0)],'round':R[V(0x69)][V(0x90)],'default':R['options'][V(0x71)],'placeholder':R[V(0x69)][V(0xe5)]}:undefined};}function initializeWidgetPsapiProperties(R,K=![]){const Q=b;!R[Q(0x64)]('exposed')&&(R[Q(0x23)]=K),!R['api_name']&&(R[Q(0x8f)]=R[Q(0x2)]),!R[Q(0x75)]&&(R[Q(0x75)]=null);}function g(){const IP=['innerHTML','minWidth','_groups','enabled','single','新节点控件已强制更新','onConfigure','checkbox','mode-option','properties','bind','color','Exclusive','71347jOvEWn','onWidgetsModified','未命名组','1777336gdRdqO','order-control','action-label','exclusive','select','BOOLEAN','100%','marginRight','20fYHqMk','action-control','Disable','dialog-title','focus','nowrap','sort','draw','alignItems','disable_','value','ignore_','label_off','false','replace','appendChild','dialog-header','callback','hasOwnProperty','call','return\x20(function()\x20','scrollTop','find','options','Comfy.GroupSwitchLoader','apply','radio','textContent','canvas','2🐕开关设置【set\x20up】','head','default','span','group-title-container','comfyClass','api_id','toString','onWidgetAdded','api_','show-checkbox','addEventListener','prototype','#ff9999','psapi','10px\x200','visible','节点\x20','min','change','button','graph','filter','preventDefault','768444GsoiIa','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#ff9800;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2010000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x203px\x206px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','630VqegKd','body','pointer','4px','console','checked','api_name','round','true','size','0.7','_nodes','htmlFor','77930ETZgey','3px\x20solid\x20#3a85ff','combo','label_on','Sort','marginLeft','onProcessStart','step','contains','_psapi_fixed_widgets','display','padding','step2','120px','719190iQywyc','getNodeMenuOptions','Comfy.GroupSwitchNodeMonitor','removeChild','16266iVeWTv','table','mode-options','some','4cZvGov','indexOf','updateWorkflowMetadata','onAdded','open','order','50px','configure','Ignore','textOverflow','whiteSpace','mode','Regular','_is_dirty','8283tcGWaG','5px','overflow','groupName','13px','10px','ignore','12px','13hMuUeq','backgroundColor','psapi_label','150px','https://space.bilibili.com/19723588?spm_id_from=333.1350.jump_directly','Mode:','fontSize','_syncInterval','_nodes_by_id','serialize','GroupSwitchNodi','borderRadius','mode-selector','widgets_config','group-switch-dialog','#999999','registerExtension','widgets','map','parentNode','trim','\x0a\x20\x20\x20\x20\x20\x20\x20\x20.group-switch-dialog\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20top:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x20-50%);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#000000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ffffff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#333333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x206px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20max-height:\x2085vh;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-y:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20600px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x202px\x208px\x20rgba(255,255,255,0.1);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20-apple-system,\x20BlinkMacSystemFont,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.dialog-header\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.dialog-title\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#eee;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.close-button\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2018px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20line-height:\x201;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20color\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.close-button:hover\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.mode-selector\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding-bottom:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#333333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.mode-selector\x20h4\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#cccccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.mode-options\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gap:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.mode-option\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.group-item\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x206px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#333333;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x204px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#111111;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.group-title\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#ffffff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.controls-container\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gap:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.switch-control,\x20.action-control\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20.mode-label,\x20.show-label,\x20.action-label\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#cccccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20input[type=\x22checkbox\x22],\x20input[type=\x22radio\x22]\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x206px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','constructor','disable','未命名组\x20','border','200px','#fff','className','log','precision','action_','3px\x20solid\x20#555','onGroupRemoved','none','placeholder','max','Enter','regular','15px','recomputeInsideNodes','psapi_fixed_groups','widget','text','cssText','name','onNodeCreated','type','number','style','trace','values','setDirtyCanvas','#2a2a2a','2px\x204px','Show','warn','length','div','Comfy.GroupNodeStateMonitor','_groupChangeCallback','computeSize','group-settings-panel','setNodeMode','keys','mouseleave','createElement','21VaXAsH','title','onRemoved','psapi_fixed_widgets','mode_','8px','toLowerCase','background','3px','🔒固定的API节点（设置已锁定）','forEach','exposed','18tFnZfE','width','opacity','action','mode-label','key','margin','click','group_','function','在主节点上显示此组的开关','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin:\x200\x200\x2010px\x200;\x22>API模式节点</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22margin:\x200;\x22>此节点已设置为API模式，配置已固化。<br/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20如需修改设置，请先取消API标记。</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cursor','borderLeft','onSerialize','mouseenter','100','groupStates','error','group-title','input','label'];g=function(){return IP;};return g();}function getGroupWidgetName(R,K){const h=b,p=R[h(0x19)]||h(0x49)+(K+0x1);return getSafeWidgetName(p);}function setupGroupSwitches(R){const t=b;if(!R[t(0xd3)])return;if(R['psapi']){app[t(0x84)]['_groups']&&app[t(0x84)]['_groups']['forEach'](k=>{const T0=t;k&&(k['recomputeInsideNodes'](),k[T0(0x94)]&&(k[T0(0x94)]=k[T0(0x94)][T0(0x85)](s=>s!==null&&s!==undefined)));});if(R[t(0x9f)]){R[t(0xd3)]=[],R[t(0x9f)][t(0x22)](k=>{const T1=t;if(k[T1(0x4)]===T1(0x98)){const s=ComfyWidgets['COMBO'](R,k['name'],[k[T1(0x4)],{'values':k[T1(0x69)]?.[T1(0x8)]||[T1(0xe8),T1(0x4d),T1(0x3e)],'default':k[T1(0x5c)]}]);s[T1(0xec)][T1(0x23)]=k['exposed'],s['widget'][T1(0x8f)]=k['api_name'],s[T1(0xec)]['api_id']=k[T1(0x75)],s['widget']['groupName']=k[T1(0xbd)];}else{if(k['type']==='toggle'){const A=ComfyWidgets['BOOLEAN'](R,k[T1(0x2)],['BOOLEAN',{'default':![],'label_on':k[T1(0x69)]?.[T1(0x99)]||'true','label_off':k[T1(0x69)]?.[T1(0x5e)]||T1(0x5f),'label':k[T1(0x69)]?.['label']||k[T1(0x2)]}]);A[T1(0xec)][T1(0x23)]=k[T1(0x23)],A[T1(0xec)]['api_name']=k[T1(0x8f)],A[T1(0xec)][T1(0x75)]=k[T1(0x75)],A[T1(0xec)][T1(0xbd)]=k[T1(0xbd)],A['widget'][T1(0x63)]=X=>{const T2=T1,W=k[T2(0xbd)];if(!W)return;const P=app[T2(0x84)][T2(0x3c)]||[],e=P[T2(0x68)](r=>{const T3=T2,c=r[T3(0x19)]||'未命名组'+(P[T3(0xad)](r)+0x1);return getGroupWidgetName(r,P[T3(0xad)](r))===W;});if(!e)return;const J=e['id']||T2(0x2c)+P[T2(0xad)](e),F=R[T2(0x43)][T2(0x35)][J];if(!F)return;const a=R[T2(0x43)][T2(0xb7)]||'regular';!F[T2(0x27)]&&(F[T2(0x27)]=T2(0xd9));F[T2(0x3d)]=!X;if(a===T2(0x4d)||a==='single'){if(X)R[T2(0xd3)][T2(0x22)](r=>{const T4=T2;if(r[T4(0xbd)]&&r[T4(0xbd)]!==W&&r[T4(0x2)]!==T4(0xb7)){const c=r[T4(0x63)];r[T4(0x63)]=null,r['value']=![],r[T4(0x63)]=c;const C=P[T4(0x68)](v=>{const T5=T4,x=v['title']||T5(0x49)+(P[T5(0xad)](v)+0x1);return getGroupWidgetName(v,P[T5(0xad)](v))===r[T5(0xbd)];});if(C){const v=C['id']||'group_'+P[T4(0xad)](C),x=R[T4(0x43)][T4(0x35)][v];x&&(x[T4(0x3d)]=!![],updateGroupNodes(C,x));}}});else{if(a===T2(0x4d)){const r=R['widgets'][T2(0xab)](c=>{const T6=T2;if(!c[T6(0xbd)]||c[T6(0xbd)]===W||c[T6(0x2)]===T6(0xb7))return![];return c['value']===!![];});if(!r){const c=A[T2(0xec)][T2(0x63)];A[T2(0xec)]['callback']=null,A[T2(0xec)][T2(0x5c)]=!![],A[T2(0xec)][T2(0x63)]=c,F[T2(0x3d)]=![];return;}}}}e&&updateGroupNodes(e,F),app[T2(0x84)]['setDirtyCanvas'](!![],!![]);};}}R[T1(0x77)]&&R[T1(0x77)](R[T1(0xd3)][R[T1(0xd3)][T1(0xe)]-0x1],R['widgets']['length']-0x1);});if(R[t(0xd3)]&&R[t(0x43)]['groupStates']){const k=app[t(0x84)]['_groups']||[];Object[t(0x15)](R[t(0x43)][t(0x35)])[t(0x22)](s=>{const T7=t,A=R[T7(0x43)][T7(0x35)][s],X=k['find'](W=>(W['id']||T7(0x2c)+k[T7(0xad)](W))===s);X&&A&&updateGroupNodes(X,A);}),R[t(0xd3)][t(0x22)](s=>{const T8=t;if(s[T8(0xbd)]&&s[T8(0x2)]!=='mode'){const A=k['find'](X=>{const T9=T8,W=X[T9(0x19)]||T9(0x49)+(k[T9(0xad)](X)+0x1);return getGroupWidgetName(X,k[T9(0xad)](X))===s[T9(0xbd)];});if(A){const X=A['id']||'group_'+k[T8(0xad)](A),W=R[T8(0x43)]['groupStates'][X];if(W){const P=s[T8(0x63)];s[T8(0x63)]=null,s[T8(0x5c)]=!W['enabled'],s['callback']=P;}}}});}delete R['_psapi_fixed_widgets'],app[t(0x84)][t(0x9)](!![],!![]),setTimeout(()=>{const TT=t;app[TT(0x84)][TT(0x9)](!![],!![]),app['canvas'][TT(0x59)](!![],!![]);},0x64);return;}return;}R[t(0xd3)]=R[t(0xd3)][t(0x85)](s=>s[t(0x2)]===t(0xb7)),R[t(0xd3)][t(0x22)](s=>{const TI=t;s[TI(0x2)]===TI(0xb7)&&initializeWidgetPsapiProperties(s,![]);});!R[t(0x43)][t(0x35)]&&(R[t(0x43)]['groupStates']={});app[t(0x84)][t(0x3c)]&&app[t(0x84)][t(0x3c)][t(0x22)](s=>{const Tg=t;s&&(s[Tg(0xea)](),s[Tg(0x94)]&&(s[Tg(0x94)]=s[Tg(0x94)][Tg(0x85)](A=>A!==null&&A!==undefined)));});const K=app['graph'][t(0x3c)]||[];K[t(0x22)](s=>{const Tb=t;s&&!s['_nodes']&&(s['_nodes']=[],s[Tb(0xea)]());});if(!K[t(0xe)])return;const p=[...K][t(0x58)]((s,A)=>{const TR=t,X=s['id']||'group_'+K['indexOf'](s),W=A['id']||TR(0x2c)+K[TR(0xad)](A),P=R['properties'][TR(0x35)][X]?.[TR(0xb1)],e=R[TR(0x43)][TR(0x35)][W]?.[TR(0xb1)];if(P===undefined&&e===undefined)return 0x0;if(P===undefined)return 0x1;if(e===undefined)return-0x1;return P-e;});p[t(0x22)]((s,A)=>{const TK=t,X=s['id']||TK(0x2c)+K[TK(0xad)](s);!R[TK(0x43)][TK(0x35)][X]&&(R[TK(0x43)][TK(0x35)][X]={'enabled':!![],'action':TK(0xd9),'visible':!![],'order':undefined});const W=R[TK(0x43)]['groupStates'][X];s[TK(0xea)]();if(W['visible']!==![]){const P=s[TK(0x19)]||TK(0x49)+(A+0x1),e=getGroupWidgetName(s,K[TK(0xad)](s)),J=ComfyWidgets[TK(0x4f)](R,e,[TK(0x4f),{'default':!W[TK(0x3d)],'label_on':TK(0x91),'label_off':TK(0x5f),'label':P}]);J&&J[TK(0xec)]&&(initializeWidgetPsapiProperties(J[TK(0xec)],![]),J[TK(0xec)][TK(0xbd)]=e),J[TK(0xec)][TK(0x63)]=F=>{const Tp=TK,a=R[Tp(0x43)]['mode']||Tp(0xe8);!W[Tp(0x27)]&&(W[Tp(0x27)]=Tp(0xd9));W['enabled']=!F;if(a===Tp(0x4d)||a===Tp(0x3e)){if(F)K[Tp(0x22)]((r,c)=>{const Tk=Tp;if(c!==A){const C=r['id']||Tk(0x2c)+c,v=R['properties'][Tk(0x35)][C];if(v&&v[Tk(0x7f)]!==![]){v['enabled']=!![],updateGroupNodes(r,v);const x=getSafeWidgetName(r[Tk(0x19)]||Tk(0x49)+(c+0x1)),z=R['widgets']['find'](O=>O[Tk(0x2)]===x);z&&(z[Tk(0x5c)]=![]);}}});else{if(a===Tp(0x4d)){const r=K[Tp(0xab)]((c,C)=>{const Ts=Tp;if(C===A)return![];const v=c['id']||Ts(0x2c)+C,x=R['properties'][Ts(0x35)][v];return x&&x['visible']!==![]&&!x[Ts(0x3d)];});if(!r){J[Tp(0xec)]['value']=!![],W[Tp(0x3d)]=![];return;}}}}updateGroupNodes(s,W),app[Tp(0x84)][Tp(0x9)](!![],!![]);},R[TK(0x77)]&&J&&R[TK(0x77)](J,R['widgets']['length']-0x1);}}),app[t(0x84)][t(0x9)](!![],!![]);}function toggleGroupNodes(R){const TA=b;app[TA(0x84)][TA(0x9)](!![],!![]);}function showSwitchSettings(R){const TX=b,K=document[TX(0x17)](TX(0xf));if(!R[TX(0x43)])R[TX(0x43)]={};if(!R[TX(0x43)][TX(0x35)])R[TX(0x43)]['groupStates']={};if(!R[TX(0x43)][TX(0xb7)])R[TX(0x43)]['mode']=TX(0xe8);K['className']=TX(0xd0);const p=document[TX(0x17)]('style');p['textContent']=TX(0xd7),document[TX(0x70)]['appendChild'](p);const k=document['createElement'](TX(0xf));k[TX(0xde)]=TX(0x62);const s=document[TX(0x17)](TX(0x83));s[TX(0x6d)]='灵仙儿和二狗子',s[TX(0x6)][TX(0xc3)]='#ff69b4',s['style'][TX(0x45)]=TX(0xdd),s[TX(0x6)][TX(0xdb)]=TX(0xe4),s[TX(0x6)]['padding']='5px\x2010px',s[TX(0x6)][TX(0xcd)]=TX(0xbb),s[TX(0x6)][TX(0x30)]=TX(0x8b),s['style'][TX(0x51)]=TX(0xbf),s[TX(0x7a)]('click',()=>{const TW=TX;window[TW(0xb0)](TW(0xc6),'_blank');}),k[TX(0x61)](s);const A=document['createElement']('h2');A[TX(0xde)]=TX(0x55),A[TX(0x6d)]=TX(0x6f),k['appendChild'](A);const X=document[TX(0x17)](TX(0x83));X[TX(0xde)]='close-button',X[TX(0x3a)]='❌',X[TX(0x19)]='关闭',X[TX(0x7a)](TX(0x2b),function(){const TP=TX,c=R;if(c){const C=c['id'];c['psapi']?(c['setDirtyCanvas'](!![],!![]),app['graph'][TP(0x9)](!![],!![])):(setupGroupSwitches(c),app[TP(0x84)]['setDirtyCanvas'](!![],!![]),setTimeout(()=>{const Te=TP,v=app[Te(0x84)][Te(0xca)][C];v&&!v['psapi']&&(v[Te(0xd3)]=v[Te(0xd3)]||[],setupGroupSwitches(v),v[Te(0x48)]&&v[Te(0x48)](),v[Te(0x9)](!![],!![]),app[Te(0x84)][Te(0x9)](!![],!![]),app['graph'][Te(0xb9)]=!![],v[Te(0x12)]&&v[Te(0x12)](),v[Te(0x9)](!![],!![]));},0x64),setTimeout(()=>{const TJ=TP;app[TJ(0x84)][TJ(0x82)](),app['graph'][TJ(0x9)](!![],!![]);},0x12c));}K&&K[TP(0xd5)]&&K[TP(0xd5)][TP(0xa7)](K),p&&p[TP(0xd5)]&&p[TP(0xd5)][TP(0xa7)](p);},![]),k[TX(0x61)](X),K['appendChild'](k);const W=document[TX(0x17)](TX(0xf));W[TX(0xde)]=TX(0xce);const P=document[TX(0x17)]('h4');P[TX(0x6d)]=TX(0xc7),W[TX(0x61)](P);const e=document['createElement'](TX(0xf));e[TX(0xde)]=TX(0xaa);const J=[{'value':TX(0xe8),'label':TX(0xb8)},{'value':TX(0x4d),'label':TX(0x46)},{'value':TX(0x3e),'label':'Single'}];J[TX(0x22)](c=>{const TF=TX,C=document[TF(0x17)]('div');C[TF(0xde)]=TF(0x42);const v=document['createElement'](TF(0x38));v['type']=TF(0x6c),v[TF(0x2)]=TF(0xb7),v[TF(0x5c)]=c[TF(0x5c)],v['id']=TF(0x1c)+c[TF(0x5c)],v[TF(0x8e)]=R[TF(0x43)]['mode']===c[TF(0x5c)],v[TF(0x6)][TF(0x51)]=TF(0xbb),v[TF(0x7a)](TF(0x82),()=>{const Ta=TF;if(v[Ta(0x8e)]){R['properties'][Ta(0xb7)]=c[Ta(0x5c)];const z=R['widgets']?R[Ta(0xd3)][Ta(0x68)](O=>O[Ta(0x2)]===Ta(0xb7)):null;z&&(z[Ta(0x5c)]=c[Ta(0x5c)]);if(R['psapi']){const O=app[Ta(0x84)][Ta(0x3c)]||[];O[Ta(0x22)]((f,o)=>{const Tr=Ta;if(!f)return;const H=f['id']||Tr(0x2c)+o,Z=R[Tr(0x43)][Tr(0x35)][H];Z&&updateGroupNodes(f,Z);});}else{setupGroupSwitches(R);const f=app[Ta(0x84)][Ta(0x3c)]||[];f[Ta(0x22)]((o,H)=>{const Tc=Ta;if(!o)return;const Z=o['id']||Tc(0x2c)+H,D=R[Tc(0x43)]['groupStates'][Z];D&&updateGroupNodes(o,D);});}app[Ta(0x84)][Ta(0x9)](!![],!![]),K&&K[Ta(0xd5)]&&K[Ta(0xd5)]['removeChild'](K),p&&p['parentNode']&&p[Ta(0xd5)]['removeChild'](p),setTimeout(()=>{showSwitchSettings(R);},0x32);}});const x=document[TF(0x17)](TF(0x39));x[TF(0x6d)]=c[TF(0x39)],x['className']=TF(0x28),x[TF(0x95)]=TF(0x1c)+c[TF(0x5c)],C[TF(0x61)](v),C['appendChild'](x),e[TF(0x61)](C);}),W['appendChild'](e),K[TX(0x61)](W);const F=app['graph'][TX(0x3c)]||[],a=document[TX(0x17)](TX(0xf));a['id']=TX(0x13),a[TX(0x6)][TX(0x2a)]=TX(0x7e),K[TX(0x61)](a);function r(){const TC=TX,c=a[TC(0x67)];a[TC(0x3a)]='';if(!R||!R[TC(0x43)]||!R[TC(0x43)][TC(0x35)])return;if(F&&F[TC(0xe)]){const C=[...F]['filter'](v=>v!=null)[TC(0x58)]((v,x)=>{const Tv=TC;if(!v||!x)return 0x0;const z=v['id']||Tv(0x2c)+F['indexOf'](v),O=x['id']||Tv(0x2c)+F['indexOf'](x);!R[Tv(0x43)][Tv(0x35)][z]&&(R[Tv(0x43)][Tv(0x35)][z]={'enabled':!![],'visible':!![],'action':'disable','order':undefined});!R[Tv(0x43)][Tv(0x35)][O]&&(R[Tv(0x43)][Tv(0x35)][O]={'enabled':!![],'visible':!![],'action':'disable','order':undefined});const f=R[Tv(0x43)][Tv(0x35)][z]['visible']!==![],o=R['properties'][Tv(0x35)][O][Tv(0x7f)]!==![];if(f!==o)return f?-0x1:0x1;const H=R[Tv(0x43)]['groupStates'][z][Tv(0xb1)],Z=R['properties'][Tv(0x35)][O]['order'];if(H!==undefined!==(Z!==undefined))return H!==undefined?-0x1:0x1;if(H!==undefined&&Z!==undefined)return H-Z;return F['indexOf'](v)-F[Tv(0xad)](x);});C['forEach']((v,x)=>{const Tx=TC,z=v['id']||Tx(0x2c)+F['indexOf'](v);!R['properties']['groupStates'][z]&&(R[Tx(0x43)]['groupStates'][z]={'enabled':!![],'action':Tx(0xd9),'visible':!![],'order':undefined});const O=R[Tx(0x43)][Tx(0x35)][z],f=document[Tx(0x17)](Tx(0xf));f[Tx(0xde)]='group-item';!O[Tx(0x7f)]?(f[Tx(0x6)][Tx(0x26)]='0.6',f[Tx(0x6)][Tx(0x45)]=Tx(0xd1),f[Tx(0x6)][Tx(0x1f)]=Tx(0xa),f[Tx(0x6)][Tx(0x31)]=Tx(0xe2)):f[Tx(0x6)][Tx(0x31)]=Tx(0x97);const o=document[Tx(0x17)](Tx(0xf));o[Tx(0xde)]=Tx(0x73),o['style'][Tx(0xa0)]='flex',o['style'][Tx(0x5a)]='center',o['style']['flex']='1',o[Tx(0x6)]['minWidth']=Tx(0xc5),o['style']['width']=Tx(0xdc),o['style']['marginRight']=Tx(0xe9),o['style'][Tx(0x30)]='pointer';const H=document[Tx(0x17)]('h4');H['className']=Tx(0x37),H[Tx(0x6d)]=v[Tx(0x19)]?v[Tx(0x19)]:Tx(0xda)+(x+0x1),H[Tx(0x6)][Tx(0x2a)]='0',H[Tx(0x6)][Tx(0xb6)]=Tx(0x57),H['style'][Tx(0xbc)]='hidden',H[Tx(0x6)][Tx(0xb5)]='ellipsis',H[Tx(0x6)]['flex']='1',H[Tx(0x6)][Tx(0x3b)]=Tx(0xa3);const Z=document[Tx(0x17)](Tx(0x72));Z[Tx(0x3a)]='✏️',Z[Tx(0x6)][Tx(0x26)]='0',Z[Tx(0x6)][Tx(0x9b)]='5px',Z[Tx(0x6)][Tx(0xc8)]=Tx(0xc1),o[Tx(0x7a)](Tx(0x33),function(){const Tz=Tx;Z[Tz(0x6)][Tz(0x26)]=Tz(0x93);}),o['addEventListener'](Tx(0x16),function(){const TO=Tx;Z['style'][TO(0x26)]='0';}),o[Tx(0x7a)](Tx(0x2b),function(){const Tf=Tx,y=document[Tf(0x17)](Tf(0x38));y[Tf(0x4)]=Tf(0x0),y[Tf(0x5c)]=v[Tf(0x19)]||Tf(0xda)+(x+0x1),y[Tf(0x6)][Tf(0x25)]=Tf(0x50),y[Tf(0x6)][Tf(0xc8)]=Tf(0xbe),y[Tf(0x6)]['fontWeight']='500',y[Tf(0x6)][Tf(0xa1)]=Tf(0xb),o[Tf(0x3a)]='',o[Tf(0x61)](y),y[Tf(0x56)](),y[Tf(0x4e)]();const n=()=>{const To=Tf,B=y['value'][To(0xd6)]();B?(v['title']=B,!R[To(0x7d)]&&setupGroupSwitches(R),app[To(0x84)][To(0x9)](!![],!![]),r()):r();};y[Tf(0x7a)]('blur',n),y[Tf(0x7a)]('keydown',function(B){const TH=Tf;if(B[TH(0x29)]===TH(0xe7))n(),B[TH(0x86)]();else B['key']==='Escape'&&(r(),B[TH(0x86)]());});}),o['appendChild'](H),o['appendChild'](Z),f['appendChild'](o);const D=document['createElement'](Tx(0xf));D['className']='controls-container';const N=document['createElement']('div');N['className']=Tx(0x4b),N[Tx(0x6)][Tx(0x51)]=Tx(0xbf);const q=document['createElement']('input');q[Tx(0x4)]=Tx(0x5),q[Tx(0x81)]='1',q['max']=Tx(0x34),q[Tx(0x5c)]=O[Tx(0xb1)]!==undefined?O['order']:'',q['placeholder']='无',q[Tx(0x6)]['width']=Tx(0xb2),q[Tx(0x6)]['marginRight']=Tx(0xbb),q[Tx(0x7a)](Tx(0x82),function(){const TZ=Tx;if(this['value']==='')O[TZ(0xb1)]=undefined,!R[TZ(0x7d)]&&setupGroupSwitches(R),app[TZ(0x84)][TZ(0x9)](!![],!![]),r();else{const y=parseInt(this[TZ(0x5c)]);y>=0x1&&y<=0x64?(O[TZ(0xb1)]=y,!R[TZ(0x7d)]&&setupGroupSwitches(R),app[TZ(0x84)]['setDirtyCanvas'](!![],!![]),r()):this[TZ(0x5c)]=O['order']!==undefined?O[TZ(0xb1)]:'';}});const l=document['createElement']('label');l[Tx(0x6d)]=Tx(0x9a),l[Tx(0xde)]='order-label',l[Tx(0x6)][Tx(0x51)]='10px',N[Tx(0x61)](q),N[Tx(0x61)](l),D[Tx(0x61)](N);const u=document[Tx(0x17)](Tx(0x38));u[Tx(0x4)]=Tx(0x41),u[Tx(0xde)]=Tx(0x79),u[Tx(0x8e)]=O['visible']||![],u[Tx(0x19)]=Tx(0x2e);const L=R;u[Tx(0x7a)](Tx(0x2b),function(){const TD=Tx;if(!L||!L[TD(0x43)]||!L[TD(0x43)][TD(0x35)])return;const y=v['id']||'group_'+F[TD(0xad)](v),n=L[TD(0x43)]['groupStates'][y];if(!n)return;n[TD(0x7f)]=this[TD(0x8e)],!L[TD(0x7d)]&&setupGroupSwitches(L),app[TD(0x84)]['setDirtyCanvas'](!![],!![]),r();}),D[Tx(0x61)](u);const w=document[Tx(0x17)](Tx(0x72));w[Tx(0x6d)]=Tx(0xc),w[Tx(0x6)]['marginLeft']=Tx(0x8c),w[Tx(0x6)][Tx(0x51)]=Tx(0xbf),D[Tx(0x61)](w);const m=document[Tx(0x17)](Tx(0xf));m[Tx(0xde)]=Tx(0x53);const G=document[Tx(0x17)](Tx(0x38));G[Tx(0x4)]='radio',G[Tx(0x2)]=Tx(0xe1)+z,G['value']=Tx(0xd9),G['id']=Tx(0x5b)+z,G[Tx(0x8e)]=O[Tx(0x27)]===Tx(0xd9),G[Tx(0x6)]['marginRight']=Tx(0x20),G[Tx(0x7a)](Tx(0x82),function(){const TN=Tx;this['checked']&&(O['action']='disable',updateGroupNodes(v,O),app['graph'][TN(0x9)](!![],!![]));});const d=document[Tx(0x17)](Tx(0x39));d[Tx(0x6d)]=Tx(0x54),d[Tx(0xde)]='action-label',d[Tx(0x95)]=Tx(0x5b)+z,d['style'][Tx(0x51)]=Tx(0x1d),m[Tx(0x61)](G),m[Tx(0x61)](d);const j=document[Tx(0x17)](Tx(0x38));j[Tx(0x4)]='radio',j[Tx(0x2)]='action_'+z,j[Tx(0x5c)]=Tx(0xc0),j['id']='ignore_'+z,j['checked']=O[Tx(0x27)]==='ignore',j['style'][Tx(0x51)]=Tx(0x20),j[Tx(0x7a)](Tx(0x82),()=>{const Tq=Tx;j[Tq(0x8e)]&&(O[Tq(0x27)]=Tq(0xc0),updateGroupNodes(v,O),app['graph']['setDirtyCanvas'](!![],!![]));});const E=document[Tx(0x17)](Tx(0x39));E[Tx(0x6d)]=Tx(0xb4),E[Tx(0xde)]=Tx(0x4c),E[Tx(0x95)]=Tx(0x5d)+z,m[Tx(0x61)](j),m[Tx(0x61)](E),D['appendChild'](m),f[Tx(0x61)](D),a[Tx(0x61)](f);});}else{const v=document[TC(0x17)]('p');v[TC(0x6d)]='⚠️\x20当前图中没有组',v[TC(0x6)][TC(0x45)]=TC(0x7c),a[TC(0x61)](v);}a[TC(0x67)]=c;}r(),document[TX(0x8a)][TX(0x61)](K);}function checkGroupNodesStatus(R){const Tl=b;if(!R[Tl(0x94)]||!R['_nodes'][Tl(0xe)])return![];return R['_nodes'][Tl(0xab)](K=>K&&K[Tl(0xb7)]===0x0);}function updateGroupNodes(R,K){const Tu=b;if(!R||!K)return;if(K[Tu(0x7f)]===![])return;let p=![];const k=K['action']||Tu(0xd9);if(!R[Tu(0x94)])return;R[Tu(0x94)]['forEach'](s=>{const TL=Tu;if(s){let A;K['enabled']?A=k===TL(0xc0)?0x4:0x2:A=0x0,s['mode']!==A&&(s[TL(0xb7)]=A,s[TL(0x9)](!![],!![]),p=!![]);}}),p&&(app[Tu(0x84)][Tu(0x9)](!![],!![]),app['canvas']&&app[Tu(0x6e)][Tu(0x59)](!![],!![])),R&&updateSwitchUIFromNodes(R);}function updateSwitchUIFromNodes(R){const Tw=b;if(!R)return;const K=R[Tw(0x94)]||[],p=K[Tw(0xab)](k=>k&&k[Tw(0xb7)]===0x0);if(!app[Tw(0x84)]||!app[Tw(0x84)]['_nodes'])return;app[Tw(0x84)][Tw(0x94)]['forEach'](k=>{const Tm=Tw;if(k['type']===Tm(0xcc)&&!k[Tm(0x7d)]){const s=app[Tm(0x84)][Tm(0x3c)]?app['graph']['_groups'][Tm(0xad)](R):-0x1;if(s===-0x1)return;const A=R['id']||Tm(0x2c)+s;(!k[Tm(0x43)]||!k['properties'][Tm(0x35)])&&(k[Tm(0x43)]=k[Tm(0x43)]||{},k['properties'][Tm(0x35)]={});!k['properties'][Tm(0x35)][A]&&(k[Tm(0x43)][Tm(0x35)][A]={'enabled':!p,'action':Tm(0xd9),'visible':!![]});const X=k[Tm(0x43)]['groupStates'][A],W=getGroupWidgetName(R,s),P=k[Tm(0xd3)]?.[Tm(0x68)](e=>e[Tm(0x2)]===W);if(P){const e=p;if(P[Tm(0x5c)]!==e){const J=P[Tm(0x63)];P[Tm(0x63)]=null,P['value']=e,X['enabled']=!e,P[Tm(0x63)]=J;}}}});}app['registerExtension']({'name':TG(0x10),async 'setup'(){const Td=TG,R=app['graph'][Td(0x14)];app['graph'][Td(0x14)]=function(k,s){const Tj=Td,A=R[Tj(0x6b)](this,arguments);return p(k),A;};const K=app[Td(0x84)]['onSerialize'];app[Td(0x84)][Td(0x32)]=function(k){const TE=Td;return app['graph'][TE(0x94)][TE(0x22)](s=>{const Ty=TE;s[Ty(0x4)]!=='GroupSwitchNodi'&&p(s);}),K?.[TE(0x6b)](this,arguments);},setInterval(()=>{const Tn=Td;app[Tn(0x84)]['_nodes'][Tn(0x22)](k=>{const TB=Tn;k[TB(0x4)]!==TB(0xcc)&&p(k);});},0x3e8);function p(k){const TM=Td;if(!k||!app[TM(0x84)])return;const s=app[TM(0x84)][TM(0x3c)]||[];s[TM(0x22)](A=>{const TU=TM;A&&A[TU(0x94)]&&A[TU(0x94)]['includes'](k)&&setTimeout(()=>{A&&updateSwitchUIFromNodes(A);},0x64);});}}});function b(T,I){const R=g();return b=function(K,p){K=K-0x0;let k=R[K];return k;},b(T,I);}function getGroupsFingerprint(R){const TY=TG;if(!R||!R['length'])return'empty';let K=R[TY(0xe)]+':';return R[TY(0x22)]((p,k)=>{const TS=TY,s=p['id']||TS(0x2c)+k,A=p[TS(0x19)]||TS(0x49)+k,X=(p[TS(0x94)]||[])[TS(0xe)];K+=s+':'+A+':'+X+';';}),K;}app[TG(0xd2)]({'name':TG(0xa6),async 'setup'(){const Ti=TG,R=new Set(),K=app[Ti(0x84)][Ti(0x9c)];app[Ti(0x84)]['onProcessStart']=function(){const TV=Ti;K&&K[TV(0x6b)](this,arguments),R[TV(0x92)]>0x0&&(R[TV(0x22)](k=>{const TQ=TV;k&&k[TQ(0x4)]===TQ(0xcc)&&(setupGroupSwitches(k),k[TQ(0x9)](!![],!![]));}),R['clear']());};const p=app[Ti(0x84)]['add'];app[Ti(0x84)]['add']=function(k){const Th=Ti,s=p[Th(0x6b)](this,arguments);if(k&&k[Th(0x4)]===Th(0xcc)){R['add'](k);const A=k['id'];setTimeout(()=>{const Tt=Th,X=app[Tt(0x84)]['_nodes_by_id'][A];X&&(X[Tt(0xd3)]=X[Tt(0xd3)]||[],!X['psapi']?(setupGroupSwitches(X),X[Tt(0x48)]&&X['onWidgetsModified'](),X[Tt(0x9)](!![],!![]),app['graph'][Tt(0x9)](!![],!![]),setTimeout(()=>{const I0=Tt;setupGroupSwitches(X),app['graph'][I0(0x82)](),app[I0(0x84)]['setDirtyCanvas'](!![],!![]);},0xc8)):(X['setDirtyCanvas'](!![],!![]),app[Tt(0x84)][Tt(0x9)](!![],!![])));},0x64);}return s;};}}),app[TG(0xd2)]({'name':'Comfy.GroupSwitchUpdated',async 'beforeRegisterNodeDef'(R){const I1=TG;if(R[I1(0x74)]==='GroupSwitchNodi'){const K=R[I1(0x7b)][I1(0x3)];R['prototype'][I1(0x3)]=function(){const I2=I1;K&&K[I2(0x6b)](this,arguments);this[I2(0x43)]={},this[I2(0x43)][I2(0x35)]={},this[I2(0x43)][I2(0xb7)]=I2(0xe8),this[I2(0x7d)]=![],this[I2(0xc4)]=null;const X=app[I2(0x84)][I2(0x3c)]||[];X[I2(0x22)]((P,e)=>{const I3=I2;if(!P)return;const J=P['id']||'group_'+e;this[I3(0x43)][I3(0x35)][J]={'enabled':!![],'action':'disable','visible':!![],'order':undefined};});const W=this['id'];setupGroupSwitches(this),this['setDirtyCanvas'](!![],!![]),setTimeout(()=>{const I4=I2,P=app[I4(0x84)][I4(0xca)][W];P&&(P[I4(0xd3)]=P[I4(0xd3)]||[],setupGroupSwitches(P),P[I4(0x48)]&&P[I4(0x48)](),P[I4(0x9)](!![],!![]),app[I4(0x84)][I4(0x9)](!![],!![]),app['graph'][I4(0xb9)]=!![],P[I4(0x12)]&&P[I4(0x12)](),P[I4(0x9)](!![],!![]),console['log'](I4(0x3f)));},0x64),setTimeout(()=>{const I5=I2;app[I5(0x84)]&&(app['graph'][I5(0x82)](),app['graph'][I5(0x9)](!![],!![]));},0x12c);};const p=R[I1(0x7b)][I1(0xaf)];R[I1(0x7b)]['onAdded']=function(){p&&p['apply'](this,arguments),setTimeout(()=>{setupGroupSwitches(this),this['setDirtyCanvas'](!![],!![]);},0x96);};const k=R[I1(0x7b)][I1(0x40)];R['prototype'][I1(0x40)]=function(X){const I6=I1;k&&k[I6(0x6b)](this,arguments),X[I6(0x7d)]?(this[I6(0x7d)]=!![],this['psapi_label']=X[I6(0xc4)]||I6(0x78)+this['id'],X[I6(0xeb)]&&(this[I6(0x43)]['groupStates']=X[I6(0xeb)]),this['_psapi_fixed_widgets']=X['psapi_fixed_widgets']):(this[I6(0x7d)]=![],this[I6(0xc4)]=null),setTimeout(()=>{const I7=I6;X[I7(0x7d)]?(setupGroupSwitches(this),X[I7(0xcf)]&&this[I7(0xd3)]&&X[I7(0xcf)][I7(0x22)](W=>{const I8=I7,P=this[I8(0xd3)][I8(0x68)](e=>e[I8(0x2)]===W[I8(0x2)]);P&&(P[I8(0x23)]=W[I8(0x23)],P[I8(0x8f)]=W['api_name']||P[I8(0x2)],P[I8(0x75)]=W['api_id']);})):setupGroupSwitches(this),this[I7(0x9)](!![],!![]);},0x64);};const s=R[I1(0x7b)][I1(0x1a)];R[I1(0x7b)][I1(0x1a)]=function(){const I9=I1;s&&s['apply'](this,arguments),this[I9(0x11)]&&LiteGraph&&(LiteGraph['onGroupAdded']=null,LiteGraph[I9(0xe3)]=null),this[I9(0xc9)]&&clearInterval(this[I9(0xc9)]);};const A=R['prototype'][I1(0xcb)];R[I1(0x7b)][I1(0xcb)]=function(){const IT=I1,X=A?A['call'](this):LGraphNode[IT(0x7b)]['serialize'][IT(0x65)](this);return this[IT(0x7d)]&&(X[IT(0x7d)]=!![],X[IT(0xc4)]=this[IT(0xc4)]||'api_'+this['id'],X[IT(0x1b)]=this[IT(0xd3)]?this[IT(0xd3)][IT(0xd4)](W=>serializeGroupSwitchWidget(W)):[],X['psapi_fixed_groups']=this[IT(0x43)][IT(0x35)]),X;};}}}),app[TG(0xd2)]({'name':TG(0x6a),async 'setup'(){const R=app['loadGraphData'];app['loadGraphData']=function(K){const II=b,p=R[II(0x6b)](this,arguments);return setTimeout(()=>{const Ig=II;app['graph'][Ig(0x94)][Ig(0x22)](k=>{const Ib=Ig;if(k[Ib(0x4)]===Ib(0xcc)){if(k[Ib(0x7d)])setupGroupSwitches(k),k[Ib(0xd3)]&&k['widgets']['forEach'](s=>{initializeWidgetPsapiProperties(s,![]);}),typeof window[Ib(0xae)]===Ib(0x2d)&&window[Ib(0xae)]();else{setupGroupSwitches(k);if(k[Ib(0xd3)]&&k['properties']['groupStates']){const s=app['graph'][Ib(0x3c)]||[];s[Ib(0x22)]((A,X)=>{const IR=Ib,W=A['id']||IR(0x2c)+X,P=k[IR(0x43)][IR(0x35)][W];if(P){updateGroupNodes(A,P);if(P[IR(0x7f)]!==![]){const e=getGroupWidgetName(A,X),J=k[IR(0xd3)][IR(0x68)](F=>F[IR(0x2)]===e);J&&(J[IR(0x5c)]=!P[IR(0x3d)]);}}});}}}}),app[Ig(0x84)]['setDirtyCanvas'](!![],!![]);},0x64),p;};}});let originalGetNodeMenuOptions=LGraphCanvas[TG(0x7b)]['getNodeMenuOptions'];LGraphCanvas[TG(0x7b)][TG(0xa5)]=function(R){const IK=TG,K=originalGetNodeMenuOptions[IK(0x6b)](this,arguments);return R[IK(0x4)]===IK(0xcc)&&(R[IK(0x7d)]?K['push']({'content':IK(0x21),'callback':()=>{const Ip=IK,p=document[Ip(0x17)](Ip(0xf));p[Ip(0x6)][Ip(0x1)]=Ip(0x88),p[Ip(0x3a)]=Ip(0x2f),document[Ip(0x8a)][Ip(0x61)](p),setTimeout(()=>{const Ik=Ip;document[Ik(0x8a)][Ik(0x9e)](p)&&document[Ik(0x8a)]['removeChild'](p);},0xbb8);}}):K['push']({'content':IK(0x6f),'callback':()=>showSwitchSettings(R)})),K;};function updateWidgetAfterGroupRename(R,K,p){const Is=TG;app[Is(0x84)][Is(0x94)]['forEach'](k=>{const IA=Is;if(k[IA(0x4)]===IA(0xcc)){const s=getSafeWidgetName(K),A=k[IA(0xd3)]?.[IA(0x68)](X=>X[IA(0x2)]===s);if(A){A['name']=getSafeWidgetName(p),A['options']['label']=p;if(A['onRemoved'])A[IA(0x1a)]();if(A['onAdded'])A[IA(0xaf)]();app[IA(0x84)]['setDirtyCanvas'](!![],!![]);}}});}app[TG(0xd2)]({'name':'Comfy.GroupSwitchNodi.PSApiIntegration',async 'setup'(){const IX=TG,R=LGraphNode[IX(0x7b)][IX(0xb3)];LGraphNode['prototype'][IX(0xb3)]=function(K){const IW=IX,p=this[IW(0x7d)],k=R[IW(0x65)](this,K);if(this[IW(0x4)]===IW(0xcc)){const s=K['psapi']||this[IW(0x7d)];if(p&&!s)console[IW(0xdf)](IW(0x80)+this['id']+'\x20从PSAPI模式切换为普通模式，重建widgets'),setTimeout(()=>{setupGroupSwitches(this),this['setDirtyCanvas'](!![],!![]);},0x64);else!p&&s&&(console['log'](IW(0x80)+this['id']+'\x20切换为PSAPI模式，固化当前widgets'),this[IW(0xd3)]&&this['widgets'][IW(0x22)](A=>{initializeWidgetPsapiProperties(A,![]);}),this['setDirtyCanvas'](!![],!![]));}return k;};}});